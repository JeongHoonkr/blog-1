# Part2 함수형 데이터 처리
##4장 - 스트림 소개
DB에서는 `select name from dishes where calorie < 400`문장 처럼 선언형으로 연산을 표현할 수 있다(직접 구현할 필요가 없다). SQL 질의 언어에서는 우리가 기대하는 것이 무엇인지 직접 표현할 수 있다. <br>

###스트림이란 무엇인가?
**스트림**이란 자바 API에 새로 추가된 기능으로, 스트림을 이용하면 선언형(즉, 데이터를 처리하는 임의 구현 코드 대신 질의로 표현할 수 있다)으로 컬렉션 데이터를 처리할 수 있다. 또한 스트림을 이용하면 멀티 스레드 코드를 구현하지 않아도 데이터를 투명하게 병렬로 처리할 수 있다. 다음 예제는 저칼로리의 요리명을 반환하고, 칼로리를 기준으로 요리를 정렬하는 자바7 코드다. 

```

List<Dish> lowCaloricDishes = new ArrayList<>();

for(Dish d : menu){

	if(d.getCalories() < 400){

		lowCaloricDishes.add(d);

	}

}



Collections.sort(lowCaloricDishes, new Comparator<Dish>() {

	public int compare(Dish d1, Dish d2){

		return Integer.compare(d1.getCalories(), d2.getCalories());

	}

});



List<String> lowCaloricDishesName = new ArrayList<>();

for(Dish d : lowCaloricDishes){

	lowCaloricDishesName.add(d.getName());

}

```

위 코드에서는 lowCaloricDishes라는 ‘가비지 변수’가 사용되었다. 즉 lowCaloricDishes는 컨테이너 역할만 하는 중간 변수다. 자바8에서 이러한 세부 구현은 라이브러리 내에서 모두 처리한다. 

```

//자바8 코드 

import static java.util.Comparator.comparing;

import static java.uitl.stream.Collectors.toList;



List<String> lowCaloricDishesName =

			menu.stream()

				.filter(d -> d.getCalories() < 400) // 400칼로리 이하의 요리 선택

				.sorted(comparing(Dish::getCalories)) // 칼로리로 요리 정렬

				.map(Dish::getName) // 요리면 추출

				.collect(toList()); // 모든 요리명을 리스트에 저장 

```

stream()을 parallelStream()으로 바꾸면 이 코드를 멀티코어 아키텍처에서 병렬로 실행할 수 있다.

```

List<String> lowCaloricDishesName =

			menu.parallelStream()

				.filter(d -> d.getCalories() < 400) // 400칼로리 이하의 요리 선택

				.sorted(comparing(Dish::getCalories)) // 칼로리로 요리 정렬

				.map(Dish::getName) // 요리면 추출

                .collect(toList()); // 모든 요리명을 리스트에 저장 

```
자세한 내용은 7장에서 설명하겠다. 

###스트림 시작하기 

스트림이란 정확히 뭘까? 스트림이란 **데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소**로 정의할 수 있다. 이 정의를 하나씩 살펴보자. <br>

연속된 요소 : 컬렉션과 마찬가지로 스트림은 특정 요소 형식으로 이루어진 연속된 값 집합의 인터페이스를 제공한다. 컬렉션은 자료구조이므로 컬렉션에서는 (예를 들어 ArrayList를 사용할 것인지 아니면 LinkedList를 사용할 것이지에 대한) 시간과 공간의 복잡성과 관련된 요소 저장 및 접근 연산이 주를 이룬다. 반면 스트림은 filter, sorted, map처럼 표현 계산식이 주를 이룬다. **즉, 컬렉션의 주제는 데이터고 스트림의 주제는 계산이다.** <br>



소스 : 스트림은 컬렉션, 배열, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비한다. 정렬된 컬렉션으로 스트림을 생성하면 정렬이 그대로 유지된다. 즉, 리스트로 스트림을 만들면 스트림의 요소는 리스트의 요소와 같은 순서를 유지한다. <br>



데이터 처리 연산 : 스트림은 함수형 프로그래밍 언어에서 일반적으로 지원하는 연산과 DB와 비슷한 연산을 지원한다. 예를 들어 filter, map, reduce, find, match, sort 등으로 데이터를 조작할 수 있다. <br>

